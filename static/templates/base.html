{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>


  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self'; script-src 'self' 'unsafe-eval' https://unpkg.com https://cdn.jsdelivr.net/npm/sweetalert2@11 'nonce-{{ csp_nonce }}'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; 
          font-src 'self' https://assets2.lottiefiles.com/packages/lf20_uiyqFZ.json https://assets10.lottiefiles.com/packages/lf20_jcikwtux.json https://fonts.gstatic.com https://cdnjs.cloudflare.com https://demo.bootstrapdash.com;           
          img-src 'self' https://assets2.lottiefiles.com/packages/lf20_uiyqFZ.json https://assets10.lottiefiles.com/packages/lf20_jcikwtux.json https://demo.bootstrapdash.com/skydash/themes/assets/images/dashboard/people.svg https://demo.bootstrapdash.com/skydash/themes/assets/images/logo-mini.svg https://demo.bootstrapdash.com/skydash/themes/assets/images/logo.svg data:;
          connect-src 'self' https://assets2.lottiefiles.com/packages/lf20_uiyqFZ.json https://assets10.lottiefiles.com/packages/lf20_jcikwtux.json; 
          frame-src 'self'; object-src 'none'; base-uri 'self';" 
/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Titan</title>
  <!-- plugins:css -->
    <script nonce="{{ csp_nonce }}" src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <link rel="stylesheet" href="{% static 'assets/vendors/feather/feather.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/ti-icons/css/themify-icons.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/css/vendor.bundle.base.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/font-awesome/css/font-awesome.min.css' %}">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <!-- <link rel="stylesheet" href="{% static 'assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css' %}"> -->
  <link rel="stylesheet" href="{% static 'assets/vendors/datatables.net-bs5/dataTables.bootstrap5.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/ti-icons/css/themify-icons.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/js/select.dataTables.min.css' %}">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="{% static 'assets/css/vertical-layout-light/style.css' %}">

  <link rel="stylesheet" href="{% static 'assets/css/css-font-awesome.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/css-materialdesignicons.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/css-themify-icons.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/css-vendor.bundle.base.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/feather-feather.css' %}">

  <!-- Titan Global Stlyes -->
  <link rel="stylesheet" href="{% static 'assets/css/titan-style.css' %}">
  <!-- endinject -->
  <link rel="shortcut icon" href="assets/images/favicon.png" />
 
  
</head>

<body>
  <div class="container-scroller">

    <!-- partial:partials/_navbar.html -->
    <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
      <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start">
        <a class="navbar-brand brand-logo me-5" href="index.html"><img src="https://demo.bootstrapdash.com/skydash/themes/assets/images/logo.svg" class="me-2"
            alt="logo" /></a>
        <a class="navbar-brand brand-logo-mini" href="index.html"><img src="https://demo.bootstrapdash.com/skydash/themes/assets/images/logo-mini.svg"
            alt="logo" /></a>
      </div>
      <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
        <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
          <span class="icon-menu"></span>
        </button>
        <ul class="navbar-nav mr-lg-2">
          <li class="nav-item nav-search d-none d-lg-block">
            <div class="input-group">
              <div class="input-group-prepend hover-cursor" id="navbar-search-icon">
                <span class="input-group-text" id="search">
                  <i class="icon-search"></i>
                </span>
              </div>
              <input type="text" class="form-control" id="navbar-search-input" placeholder="Search now" aria-label="search"
                aria-describedby="search">
            </div>
          </li>
        </ul>
        <ul class="navbar-nav navbar-nav-right">
            <li class="nav-item dropdown">
              <a
                class="nav-link count-indicator ms-2"
                id="barcodeStatus"
                href="#"
              >
                <img
                  src="{% static 'assets/gif/barcode.gif' %}"
                  alt="Barcode"
                  class="barcode-icon"
                />
              </a>
              <span style="display: inline-block; width: 4px"></span>

              <a
                class="nav-link count-indicator dropdown-toggle ms-2"
                id="notificationDropdown"
                href="#"
                data-bs-toggle="dropdown"
              >
                <i class="icon-bell mx-0"></i>
                <span class="count"></span>
              </a>

              <div
                class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
                aria-labelledby="notificationDropdown"
              >
                <p class="mb-0 font-weight-normal float-left dropdown-header">
                  Notifications
                </p>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-success">
                      <i class="ti-info-alt mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">
                      Application Error
                    </h6>
                    <p class="font-weight-light small-text mb-0 text-muted">
                      Just now
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-warning">
                      <i class="ti-settings mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">Settings</h6>
                    <p class="font-weight-light small-text mb-0 text-muted">
                      Private message
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-info">
                      <i class="ti-user mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">
                      New user registration
                    </h6>
                    <p class="font-weight-light small-text mb-0 text-muted">
                      2 days ago
                    </p>
                  </div>
                </a>
              </div>
            </li>
            <li class="nav-item nav-profile dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                data-bs-toggle="dropdown"
                id="profileDropdown"
              >
                <img
                  src="{% static 'assets/images/userProfile.png' %}"
                  alt="profile"
                  style="width:26px; height:26px; object-fit:cover; border-radius:50%;"

                />
              </a>
              <div
                class="dropdown-menu dropdown-menu-right navbar-dropdown"
                aria-labelledby="profileDropdown"
              >
                <a class="dropdown-item">
                  <i class="ti-settings text-primary"></i>
                  Settings
                </a>
<!-- Swap User -->
<a class="dropdown-item" id="swapUserBtn" style="position: relative;">
  <i class="ti-user text-primary"></i> Swap User

  <!-- Mini sub option -->
  <div id="swapUserSubMenu"
    style="display: none; position: absolute; right: 100%; top: 0; min-width: 170px; background: #fff; border: 1px solid #ddd; border-radius: 6px; box-shadow: 0 4px 16px rgba(0,0,0,0.10); z-index: 9999; text-align: center; padding: 5px;">
    <a href="#" id="addAccountBtn"
      style="display: block; min-width: 100px; background: #fff; text-align: center; padding: 6px 0 14px 0; margin: 0 auto; font-weight: 500; position: relative; top: -6px;"> Add Account</a>
    
  </div>
</a>

                <a class="dropdown-item">
                  <i class="ti-power-off text-primary"></i>
                  Logout
                </a>
              </div>
            </li>
           <!--  <li class="nav-item nav-settings d-none d-lg-flex">
              <a class="nav-link" href="#">
                <i class="icon-ellipsis"></i>
              </a>
            </li> -->
          </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
          data-toggle="offcanvas">
          <span class="icon-menu"></span>
        </button>
      </div>
    </nav>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:partials/_settings-panel.html -->
      
      <div id="right-sidebar" class="settings-panel">
        <i class="settings-close ti-close"></i>
        <ul class="nav nav-tabs border-top" id="setting-panel" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="todo-tab" data-bs-toggle="tab" href="#todo-section" role="tab"
              aria-controls="todo-section" aria-expanded="true">TO DO LIST</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="chats-tab" data-bs-toggle="tab" href="#chats-section" role="tab"
              aria-controls="chats-section">CHATS</a>
          </li>
        </ul>
        <div class="tab-content" id="setting-content">
          <div class="tab-pane fade show active scroll-wrapper" id="todo-section" role="tabpanel"
            aria-labelledby="todo-section">
            <div class="add-items d-flex px-3 mb-0">
              <form class="form w-100">
                <div class="form-group d-flex">
                  <input type="text" class="form-control todo-list-input" placeholder="Add To-do">
                  <button type="submit" class="add btn btn-primary todo-list-add-btn" id="add-task">Add</button>
                </div>
              </form>
            </div>
            <div class="list-wrapper px-3">
              <ul class="d-flex flex-column-reverse todo-list">
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Team review meeting at 3.00 PM
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Prepare for presentation
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Resolve all the low priority tickets due today
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li class="completed">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox" checked>
                      Schedule meeting for next week
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li class="completed">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox" checked>
                      Project review
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
              </ul>
            </div>
            <h4 class="px-3 text-muted mt-5 font-weight-light mb-0">Events</h4>
            <div class="events pt-4 px-3">
              <div class="wrapper d-flex mb-2">
                <i class="ti-control-record text-primary me-2"></i>
                <span>Feb 11 2018</span>
              </div>
              <p class="mb-0 font-weight-thin text-gray">Creating component page build a js</p>
              <p class="text-gray mb-0">The total number of sessions</p>
            </div>
            <div class="events pt-4 px-3">
              <div class="wrapper d-flex mb-2">
                <i class="ti-control-record text-primary me-2"></i>
                <span>Feb 7 2018</span>
              </div>
              <p class="mb-0 font-weight-thin text-gray">Meeting with Alisa</p>
              <p class="text-gray mb-0 ">Call Sarah Graves</p>
            </div>
          </div>
          <!-- To do section tab ends -->
          <div class="tab-pane fade" id="chats-section" role="tabpanel" aria-labelledby="chats-section">
            <div class="d-flex align-items-center justify-content-between border-bottom">
              <p class="settings-heading border-top-0 mb-3 ps-3 pt-0 border-bottom-0 pb-0">Friends</p>
              <small class="settings-heading border-top-0 mb-3 pt-0 border-bottom-0 pb-0 pr-3 font-weight-normal">See
                All</small>
            </div>
            <ul class="chat-list">
              <li class="list active">
                <div class="profile"><img src="{% static 'assets/images/faces/face1.jpg' %}" alt="image"><span
                    class="online"></span></div>
                <div class="info">
                  <p>Thomas Douglas</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">19 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="{% static 'assets/images/faces/face2.jpg' %}" alt="image"><span
                    class="offline"></span></div>
                <div class="info">
                  <div class="wrapper d-flex">
                    <p>Catherine</p>
                  </div>
                  <p>Away</p>
                </div>
                <div class="badge badge-success badge-pill my-auto mx-2">4</div>
                <small class="text-muted my-auto">23 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="{% static 'assets/images/faces/face3.jpg' %}" alt="image"><span
                    class="online"></span></div>
                <div class="info">
                  <p>Daniel Russell</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">14 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="{% static 'assets/images/faces/face4.jpg' %}" alt="image"><span
                    class="offline"></span></div>
                <div class="info">
                  <p>James Richardson</p>
                  <p>Away</p>
                </div>
                <small class="text-muted my-auto">2 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="{% static 'assets/images/faces/face5.jpg' %}" alt="image"><span
                    class="online"></span></div>
                <div class="info">
                  <p>Madeline Kennedy</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">5 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="{% static 'assets/images/faces/face6.jpg' %}" alt="image"><span
                    class="online"></span></div>
                <div class="info">
                  <p>Sarah Graves</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">47 min</small>
              </li>
            </ul>
          </div>
          <!-- chat tab ends -->
        </div>
      </div>
      <!-- partial -->
      <!-- partial:partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="icon-grid menu-icon"></i>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          <!-- Day Planning Menu -->
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#ui-basic" aria-expanded="false" aria-controls="ui-basic">
              <i class="icon-watch menu-icon"></i>
              <span class="menu-title">Day Planning</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="ui-basic">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="{% url 'bulk_upload' %}">Bulk Upload</a></li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'dp_pick_table' %}"
                  >DP Pick Table</a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'dp_completed_table' %}"
                  >DP Completed Table</a
                  >
                </li>
              </ul>
            </div>
          </li>

                                           <!-- Recovery Onboard Menu -->
                      <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="collapse" href="#recovery-onboard" aria-expanded="false" aria-controls="recovery-onboard">
                            <i class="ti-loop menu-icon"></i>
                          <span class="menu-title">Recovery Onboard</span>
                          <i class="menu-arrow"></i>
                        </a>
                        <div class="collapse" id="recovery-onboard">
                          <ul class="nav flex-column sub-menu">
                            <li class="nav-item">
                              <a class="nav-link" href="{% url 'recovery_BulkUpload' %}">R- Bulk Upload</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" href="{% url 'recovery_dp_pick_table' %}">R - DP Pick Table</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" href="{% url 'recovery_dp_completed_table' %}">R - DP Completed Table</a>
                            </li>
                          </ul>
                        </div>
                      </li>
         

          <!-- Input Screening Menu -->
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#ui-advanced" aria-expanded="false" aria-controls="ui-advanced">
              <i class="icon-layers menu-icon"></i>
              <span class="menu-title">Input Screening</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="ui-advanced">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> 
                  <a class="nav-link" href="#">Pick Table</a>
                </li>
                <li class="nav-item"> 
                  <a class="nav-link" href="#">Accept</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Reject</a>
                </li>
              </ul>
            </div>
          </li>

<!-- Jig Loading Menu -->
<li class="nav-item">
  <a class="nav-link" data-bs-toggle="collapse" href="#jig-loading" aria-expanded="false" aria-controls="jig-loading">
    <i class="ti-package menu-icon"></i>
    <span class="menu-title">Jig Loading</span>
    <i class="menu-arrow"></i>
  </a>
  <div class="collapse" id="jig-loading">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'jig_composition' %}">Jig Composition</a>
      </li>
    </ul>
  </div>
</li>

<!-- In-process Inspection Menu -->

<li class="nav-item">
  <a class="nav-link" data-bs-toggle="collapse" href="#inprocessInspectionMenu" aria-expanded="false" aria-controls="inprocessInspectionMenu">
    <i class="ti-eye menu-icon"></i>
    <span class="menu-title">Ip Inspection</span>
    <i class="menu-arrow"></i>
  </a>
  <div class="collapse" id="inprocessInspectionMenu">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'inprocess_inspection_main' %}">IP Main</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'inprocess_inspection_complete' %}">IP Completed</a>
      </li>
      
    </ul>
  </div>
</li>


 <!-- Jig Unloading Menu -->
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#tables" aria-expanded="false" aria-controls="jig-loading">
              <i class="ti-truck menu-icon"></i>
              <span class="menu-title">Jig Unloading</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="tables">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'Jig_Unloading_MainTable' %}">JUL Main Table</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">JUL Completed Table</a>
                </li>
              </ul>
            </div>
          </li>

<!-- Nickel Audit Menu -->
<li class="nav-item">
  <a class="nav-link" data-bs-toggle="collapse" href="#nickelAuditMenu" aria-expanded="false" aria-controls="nickelAuditMenu">
    <i class="ti-medall menu-icon"></i>
    <span class="menu-title">Nickel Audit</span>
    <i class="menu-arrow"></i>
  </a>
  <div class="collapse" id="nickelAuditMenu">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'NA_Main_Table' %}">NA Pick Table</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'NA_Complete_Table' %}">NA Completed</a>
      </li>
    </ul>
  </div>
</li>


<!-- Spider Spindle Menu -->
<li class="nav-item">
  <a class="nav-link" data-bs-toggle="collapse" href="#spiderSpindleMenu" aria-expanded="false" aria-controls="spiderSpindleMenu">
    <i class="ti-control-shuffle menu-icon"></i>
    <span class="menu-title">Spider Spindle</span>
    <i class="menu-arrow"></i>
  </a>
  <div class="collapse" id="spiderSpindleMenu">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'spider_pick_table' %}">Spider Pick Table</a>
      </li>
      
    </ul>
  </div>
</li>

        </ul>
      </nav>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-md-12 grid-margin">
                <div class="row">
                    {% block content %}{% endblock %}
                </div>
            </div>
          </div>

        <!-- content-wrapper ends -->
        <!-- partial:partials/_footer.html -->
        <footer class="footer">
          <div class="d-sm-flex justify-content-center justify-content-sm-between">
            <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">Copyright © 2025.  Pinesphere </span>
            
          </div>
        </footer>
        <!-- partial -->
      </div>
      
    </div>
    <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->

  <!-- plugins:js -->
  <!-- Tray IDentification Form Section via gif barcode -->

     <div id="barcodeModal" class="barcode-modal">
      <div class="barcode-modal-content">
        <div
          class="row align-items-center mb-3"
          style="position: relative; margin-top: -10px"
        >
          <div class="col-2 d-flex align-items-center">
            <span
              class="barcode-modal-close"
              id="barcodeModalClose"
              style="font-size: 1.5rem; cursor: pointer"
              >&times;</span
            >
          </div>
          <div class="col-8 text-center">
            <h4
              class="mb-0 fw-bold"
              style="font-size: 1.25rem; line-height: 1.1"
            >
              Tray Identification
            </h4>
            <input type="text" id="trayHiddenInput" style="position:absolute; left:-9999px;" autocomplete="off" />

          </div>
          <div class="col-2"></div>
        </div>

        <!-- Banner Image -->
        <div class="barcode-banner-img-wrapper text-center mb-4">
          <img
            src="{% static 'assets/images/banner2.jpg' %}"
            alt="Banner"
            class="barcode-banner-img"
            style="max-width: 100%; border-radius: 10px"
          />
        </div>

        <!-- Tray Identification Table -->
        <form id="barcodeScannerForm" autocomplete="off">
          <table class="table table-bordered align-middle mb-3">
            <tbody>
              <tr>
                <th style="width: 40%">Model No</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="modelNo"
                    placeholder="Model Number"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Version</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="version"
                    placeholder="Version"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Polish Finish</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="polishFinish"
                    placeholder="Polish Finish"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Plating Color</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="platingColor"
                    placeholder="Plating Color"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Source</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="source"
                    placeholder="Source"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Type of Input</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="inputType"
                    placeholder="Type of Input"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Last Process Date &amp; Time</th>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    id="lastProcessDate"
                    placeholder="Auto Fetch"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>Last Process Module</th>
                <td>
                  <div class="module-highlight last-module mb-2" id="lastProcessModule">
                    None
                  </div>
                </td>
              </tr>
              <tr>
                <th>Next Process Module</th>
                <td>
                  <div class="module-highlight next-module mb-2" id="nextProcessModule">
                    None
                  </div>
                </td>
              </tr>
              <tr>
                <th>Images</th>
                <td>
                <div class="barcode-image-section text-center" id="modelImagesContainer">
                    <img
                      src="{% static 'assets/images/dashboard.jpg' %}"
                      alt="Sample 1"
                      class="barcode-img-preview mx-2"
                      style="
                        max-width: 80px;
                        max-height: 80px;
                        border-radius: 8px;
                      "
                    />
                    <img
                      src="{% static 'assets/images/dashboard.jpg' %}"
                      alt="Sample 2"
                      class="barcode-img-preview mx-2"
                      style="
                        max-width: 80px;
                        max-height: 80px;
                        border-radius: 8px;
                      "
                    />
                    <img
                      src="{% static 'assets/images/dashboard.jpg' %}"
                      alt="Sample 3"
                      class="barcode-img-preview mx-2"
                      style="
                        max-width: 80px;
                        max-height: 80px;
                        border-radius: 8px;
                      "
                    />
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="text-center"></div>
        </form>
      </div>
    </div>

    <!-- Script for Tray Identification Form -->


    <script nonce="{{ csp_nonce }}">
      // Tablet image zoom toggle
      document.querySelectorAll(".barcode-img-preview").forEach(function (img) {
        img.addEventListener("click", function (e) {
          // Only apply on tablet screens
          if (window.innerWidth <= 991.98) {
            e.preventDefault();
            // Toggle zoomed class
            this.classList.toggle("zoomed");
          }
        });
      });
    </script>

      <script nonce="{{ csp_nonce }}">
          // Open modal on barcode click
          document.getElementById("barcodeStatus").onclick = function (e) {
            e.preventDefault();
            document.getElementById("barcodeModal").style.display = "flex";
            setTimeout(function() {
              document.getElementById("trayHiddenInput").focus();
            }, 100);
          };
          document.getElementById("barcodeModalClose").onclick = function () {
            document.getElementById("barcodeModal").style.display = "none";
          };
          window.onclick = function (event) {
            var modal = document.getElementById("barcodeModal");
            if (event.target === modal) {
              modal.style.display = "none";
            }
          };
        
          // Always keep focus on the hidden input
          const trayInput = document.getElementById("trayHiddenInput");
          document.getElementById("barcodeModal").addEventListener("click", function() {
            trayInput.focus();
          });
          trayInput.addEventListener("blur", function() {
            setTimeout(() => trayInput.focus(), 10);
          });
        
          // Debounce logic for barcode input and fetch details from API
          let debounceTimer = null;
          trayInput.addEventListener("input", function() {
            if (debounceTimer) clearTimeout(debounceTimer);
            debounceTimer = setTimeout(function() {
              const trayId = trayInput.value.trim();
              if (trayId !== "") {
                // Call BaseAPIView with trayId as barcodeInput
                fetch(`/modelmaster/base/?barcodeInput=${encodeURIComponent(trayId)}`, {
                  method: "GET",
                  headers: {
                    "Accept": "application/json"
                  },
                  credentials: "same-origin"
                })
                .then(response => response.json())
                .then(data => {
                  // Update the modal fields with the fetched data
                  if (data.tray_details) {
                    document.getElementById("modelNo").value = data.model_master_details?.model_stock_no || "";
                    document.getElementById("version").value = data.model_master_details?.version || "";
                    document.getElementById("polishFinish").value = data.model_master_details?.polish_finish || "";
                    document.getElementById("platingColor").value = data.model_master_details?.plating_color || "";
                    document.getElementById("source").value = data.model_master_details?.vendor_internal || "";
                    document.getElementById("inputType").value = data.total_stock_details?.total_stock || "";
                    document.getElementById("lastProcessDate").value = data.total_stock_details?.last_process_date_time || "";   
                    document.getElementById("lastProcessModule").innerText = data.total_stock_details?.last_process_module || "";
                    document.getElementById("nextProcessModule").innerText = data.total_stock_details?.next_process_module || "";
                     // ✅ Update image section with model images
                    const imageSection = document.querySelector('.barcode-image-section');
                    imageSection.innerHTML = ''; // Clear previous images

                    const images = data.model_master_details?.model_images || [];
                    images.forEach(url => {
                      const img = document.createElement('img');
                      img.src = url;
                      img.alt = "Model Image";
                      img.className = "barcode-img-preview mx-2";
                      img.style.maxWidth = "80px";
                      img.style.maxHeight = "80px";
                      img.style.borderRadius = "8px";
                      imageSection.appendChild(img);
                    });
                    
                  } else {
                    // Clear fields or show error if not found
                    document.getElementById("modelNo").value = "";
                    document.getElementById("version").value = "";
                    document.getElementById("polishFinish").value = "";
                    document.getElementById("platingColor").value = "";
                    document.getElementById("source").value = "";
                    document.getElementById("inputType").value = "";
                    document.getElementById("lastProcessDate").value = "";
                    document.getElementById("lastProcessModule").innerText = "";
                    document.getElementById("nextProcessModule").innerText = "";
                // ✅ Clear images
                    const imageSection = document.querySelector('.barcode-image-section');
                    imageSection.innerHTML = '';

                    alert(data.error || "Tray not found"); 
                   }
                  trayInput.value = ""; // Clear input after processing
                })
                .catch(err => {
                  alert("Error fetching tray details");
                  trayInput.value = "";
                });
              }
            }, 500); // 500ms after user stops typing
          });
        </script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/vendors/js/vendor.bundle.base.js' %}"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/vendors/chart.js/chart.umd.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/vendors/datatables.net/jquery.dataTables.js' %}"></script>
  <!-- <script nonce="{{ csp_nonce }}" src="{% static 'assets/vendors/datatables.net-bs4/dataTables.bootstrap4.js' %}"></script> -->
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/vendors/datatables.net-bs5/dataTables.bootstrap5.js' %}"></script>

  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/dataTables.select.min.js' %}"></script>

  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/off-canvas.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/hoverable-collapse.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/template.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/settings.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/todolist.js' %}"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
<script nonce="{{ csp_nonce }}" src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>


  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/jquery.cookie.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/dashboard.js' %}"></script>
  <script nonce="{{ csp_nonce }}" src="{% static 'assets/js/Chart.roundedBarCharts.js' %}"></script>
  <!-- End custom js for this page-->



 <!-- Modal for Add Account (reuse your previous modal) -->
<div class="modal fade" id="swapUserModal" tabindex="-1" role="dialog" aria-labelledby="swapUserModalLabel" aria-hidden="true" style="display:none; background:rgba(0,0,0,0.35); position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1050;">
  <div class="modal-dialog" role="document" style="margin-top:10%;">
    <div class="modal-content" style="border-radius:10px;">
      <div class="modal-header">
        <h5 class="modal-title" id="swapUserModalLabel">Add New User</h5>
        <button type="button" class="close" id="closeSwapUserModal" aria-label="Close" style="border:none; background:none; font-size:1.5rem;">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control mb-2" placeholder="Enter new user ID or name">
        <button class="btn btn-primary w-100">Swap</button>
      </div>
    </div>
  </div>
</div>

  <!-- Script to handle Add User -->
<script nonce="{{ csp_nonce }}">
// Show/hide mini sub option on hover/click
const swapUserBtn = document.getElementById('swapUserBtn');
const swapUserSubMenu = document.getElementById('swapUserSubMenu');
swapUserBtn.onmouseenter = function() {
  swapUserSubMenu.style.display = 'block';
};
swapUserBtn.onmouseleave = function() {
  swapUserSubMenu.style.display = 'none';
};
// Show modal when "Add Account" is clicked
document.getElementById('addAccountBtn').onclick = function(e) {
  e.preventDefault();
  document.getElementById('swapUserModal').style.display = 'block';
  swapUserSubMenu.style.display = 'none';
};
// Hide modal
document.getElementById('closeSwapUserModal').onclick = function() {
  document.getElementById('swapUserModal').style.display = 'none';
};
// Hide modal when clicking outside modal-content
document.getElementById('swapUserModal').onclick = function(e) {
  if (e.target === this) this.style.display = 'none';
};
</script>

</body>

</html>